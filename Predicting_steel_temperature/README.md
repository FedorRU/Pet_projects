# Определение температуры стали.   

## Оглавление  
[1. Описание проекта](https://github.com/FedorRU/Pet_projects/edit/main/Predicting_steel_temperature/README.md#Описание-проекта)  
[2. Постановка задачи](https://github.com/FedorRU/Pet_projects/edit/main/Predicting_steel_temperature/README.md#Постановка-задачи)  
[3. Краткая информация о данных](https://github.com/FedorRU/Pet_projects/edit/main/Predicting_steel_temperature/README.md#Краткая-информация-о-данных)  
[4. Этапы работы над проектом](https://github.com/FedorRU/Pet_projects/edit/main/Predicting_steel_temperature/README.md#Этапы-работы-над-проектом)  
[5. Результат](https://github.com/FedorRU/Pet_projects/edit/main/Predicting_steel_temperature/README.md#Результат)  

### Описание проекта  
Чтобы оптимизировать производственные расходы, металлургический комбинат ООО «Так закаляем сталь» решил уменьшить потребление электроэнергии на этапе обработки стали.

### Постановка задачи
Построить модель, которая будет предсказывать температуру этого сплава.

Метрика качества — **MAE**

### Краткая информация о данных

Данные состоят из файлов, полученных из разных источников:

- `data_arc.csv` — данные об электродах;
- `data_bulk.csv` — данные о подаче сыпучих материалов (объём);
- `data_bulk_time.csv` *—* данные о подаче сыпучих материалов (время);
- `data_gas.csv` — данные о продувке сплава газом;
- `data_temp.csv` — результаты измерения температуры;
- `data_wire.csv` — данные о проволочных материалах (объём);
- `data_wire_time.csv` — данные о проволочных материалах (время).

Во всех файлах столбец `key` содержит номер партии. В файлах может быть несколько строк с одинаковым значением `key`: они соответствуют разным итерациям обработки.

### Этапы работы над проектом  

 - Анализ данных:
     - Основным шагом здесь является не рассмотрение пропусков и аномали, а понимание процесса производства.
 - Подготовка данных
     - Создание сводной таблицы
     - Создание новых признаков
 - Анализ моделей
     - Обучени и поиск гиперпарметров
     - Анализ факторов важности

### Результат:  
Основная трудность заключалась в последовательном рассмотрении производственного цикла. Малое количество данных о используемых материалах сильно сказывается на объеме данных, анализируемых моделью. Так от большого количества итераций в партиях пришлось избавиться из-за нехватки данных. 

  
**Лучшая модель - LGBMRegressor. MAE = 6.56**
- Параметры модели:
    - *learning_rate = 0.1*
    - *max_depth = 8*
    - *n_estimators = 50*
- Признаки используемые в обучении:
    - *bulk (3,4,6,14,15)* - объем сыпучих материалов. Были убраны итерации в паотиях, где отсутвовали данные признаки.
    - *sum_x* - объем сыпучих материалов, а именно сумма материалов с малым количеством наблюдений.
    - *gas* - данные о продувке газом. 
    - *first_temp* - замер температуры в партии, до начала производственного цикла.
    - *wire (1,2)* - объем проволочных материалов. Обработка аналогична сыпучим матреиалам.
    - *sum_y* - объем проволочных материалов, а именно сумма материалов с малым количеством наблюдений.
    - *apparent_power* - Полная мощность, рассчитанная по формуле $S=\sqrt{P^2+Q^2}$
    - *sec_between* - время между окончанием процесса и змерением температуры
    - *power_coeff*	- клэффициент мощности $Pf=P/S$

